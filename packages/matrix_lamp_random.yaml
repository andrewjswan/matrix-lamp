switch:
  # Random Mode Settings
  - platform: template
    name: Random Mode
    icon: mdi:shuffle
    id: random_mode
    lambda: |-
      return id(matrix).get_random_settings();
    turn_on_action:
      - lambda: |-
          id(matrix).set_random_settings(true);
    turn_off_action:
      - lambda: |-
          id(matrix).set_random_settings(false);

interval:
  - interval: 15min
    then:
      - lambda: |-
          if (!id(random_mode).state) {
            return;
          }

          const auto &effects = id(neopixel_led)->get_effects();
          uint8_t total = effects.size();
          std::string curr_effect = id(neopixel_led)->get_effect_name();

          uint8_t rand;
          do
          {
            rand = random(total) + 1;
          } while (
                    (strcmp(effects[rand]->get_name(), "None") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Magic Lantern") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Cloud in a Jar") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Thunderstorm in a Jar") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Snowfall") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Arrows") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Lotus Flower") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Fountain") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Scanner") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Colors") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Strobe") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Strobe Police") == 0) ||
                    (strcmp(effects[rand]->get_name(), "White light") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Sunrise") == 0) ||
                    (strcmp(effects[rand]->get_name(), "Clock Full") == 0) ||
                    (strcmp(effects[rand]->get_name(), "WLED / DDP") == 0) ||
                    (strcmp(effects[rand]->get_name(), curr_effect.c_str()) == 0)
                  );

          // Set random effect
          auto call = id(neopixel_led)->turn_on();
          call.set_effect(rand);
          call.perform();
